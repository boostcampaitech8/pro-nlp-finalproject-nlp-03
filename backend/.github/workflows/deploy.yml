# .github/workflows/deploy.yml
name: Deploy Backend to NCP

on:
  push:
    branches:
      - feature/backend

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: SSH Deploy
        uses: appleboy/ssh-action@master
        with:
          host: 211.188.62.72
          username: root
          key: ${{ secrets.NCP_SSH_KEY }}
          script: |
            cd ~/recipe-app/backend
            git pull origin feature/backend
            cd ~/recipe-app
            sudo docker compose down
            sudo docker compose build --no-cache backend
            sudo docker compose up -d
            sudo docker compose logs backend | tail -20
